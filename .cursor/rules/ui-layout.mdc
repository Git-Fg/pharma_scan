---
description: Layout standards, Gap usage, and Responsive design
alwaysApply: false
---

# UI Layout & Spacing (2025 Standard)

## The Hybrid Spacing Matrix

With Flutter 3.27+, we adhere to a strict decision matrix for spacing to optimize performance and semantics.

| Scenario | Tool | Logic |
| :--- | :--- | :--- |
| **Uniform Lists** (Grids, Button Bars) | **Native `spacing`** | `Row(spacing: 8, children: ...)` - Zero widget inflation. |
| **Semantic Grouping** (Sections, Forms) | **Gap Package** | `Column(children: [Header(), Gap(32), Form()])` - Semantic breaks. |
| **Scroll Views** (Slivers) | **SliverGap** | `SliverGap(16)` - Avoids `SliverToBoxAdapter` overhead. |
| **Responsive Constraints** | **MaxGap** | Prevents overflow errors on small screens. |

## Responsive Design

**1. Breakpoints**

- Use `ShadResponsiveBuilder` or `context.breakpoint` (Shadcn theme).
- **Forbidden:** Raw `MediaQuery.of(context).size.width` checks.

**2. The "Thumb Zone" Rule**

- **Sheets:** Prefer `ShadSheet` (Side: Bottom) for complex interactions on mobile.
- **Dialogs:** Reserve for critical confirmations only.

## Performance Constraints

**1. The Blur Bottleneck (Impeller/Android)**

- **Problem:** `BackdropFilter` (used in Shadcn Sheets/Dialogs) causes shader jank on low-end Android.
- **Mandate:** In `theme.dart`, configure `modalBarrierColor` to use a solid transparent color (e.g., `Colors.black54`) instead of blur if performance issues arise.

**2. Render Tree Depth**

- Avoid nesting `Padding` > `Container` > `Padding`. Use `Container(padding: ...)` or `Gap` to flatten the tree.

## Anti-Patterns

- ❌ Using `Gap` inside a `Stack` (It has no flow direction).
- ❌ Using `Gap` at the start/end of a list (Use `padding` on the container).
- ❌ `SliverToBoxAdapter(child: SizedBox(...))` -> Use `SliverGap`.
