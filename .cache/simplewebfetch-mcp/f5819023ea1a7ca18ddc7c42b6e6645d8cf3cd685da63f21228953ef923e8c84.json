{
  "url": "https://pub.dev/documentation/fast_csv/latest",
  "markdown": "# fast_csv - Dart API docs\nmenu[![](https://pub.dev/static/hash-jnfujih4/img/dart-logo.svg)](https://pub.dev/)\n1.  [fast\\_csv package](https://pub.dev/packages/fast_csv)\n2.  documentation\nfast\\_csv package\ndark\\_modelight\\_mode\n# fast\\_csv\nClassic CSV parsers suitable for most use cases. Pretty fast parsing. With experimental event-based streaming parsing.\nVersion: 0.2.11\n[![Pub Package](https://img.shields.io/pub/v/fast_csv.svg)](https://pub.dev/packages/fast_csv) [![GitHub Issues](https://img.shields.io/github/issues/mezoni/csv_parser.svg)](https://github.com/mezoni/csv_parser/issues) [![GitHub Forks](https://img.shields.io/github/forks/mezoni/csv_parser.svg)](https://github.com/mezoni/csv_parser/forks) [![GitHub Stars](https://img.shields.io/github/stars/mezoni/csv_parser.svg)](https://github.com/mezoni/csv_parser/stargazers) [![GitHub License](https://img.shields.io/badge/License-BSD_3--Clause-blue.svg)](https://raw.githubusercontent.com/mezoni/csv_parser/main/LICENSE)\n## About testing generated parsers\nBoth parsers have been tested in both operating modes, synchronous and asynchronous modes.\nFor testing, files from the following source are used:\n`CSV is a data directory which contains examples of CSV files, a flat file format describing values in a table.`\n[https://people.sc.fsu.edu/~jburkardt/data/csv/csv.html](https://people.sc.fsu.edu/~jburkardt/data/csv/csv.html)\nAll files are parsed except for the malformed file `mlb_players.csv`.\nIt has unclosed quote on row 1036.\n## Example of the parser usage\nAn example of a simple way to parse 1000K rows (53M UTF-16 code units) in chunks (by ~0.53M UTF-16 code units) using events without consuming a lot of memory (during parsing) and simultaneously saving this parsed data into a virtual database (by 10K rows per transaction).\n```dart\nimport 'dart:async';\nimport 'package:fast_csv/csv_converter.dart';\nFuture<void> main(List<String> args) async {\n  _exampleParseString();\n  await _exampleParseStreamWithEvents();\n}\nconst _data = '''\nYear,Make,Model,Description,Price\n1997,Ford,E350,\"ac, abs, moon\",3000.00\n1999,Chevy,\"Venture \"\"Extended Edition\"\"\",\"\",4900.00\n1999,Chevy,\"Venture \"\"Extended Edition, Very Large\"\"\",\"\",5000.00\n1996,Jeep,Grand Cherokee,\"MUST SELL!\nair, moon roof, loaded\",4799.00\n''';\nStream<String> _createStream() {\n  // Create the stream with 1000000 rows\n  const count = 1000 * 1000;\n  final controller = StreamController<String>();\n  final sink = controller.sink;\n  const row = '1999,Chevy,\"Venture В«Extended EditionВ»\",\"\",4900.00';\n  const rowsInChunk = count ~/ 100;\n  final chunk = List.generate(rowsInChunk, (i) => row).join('\\n');\n  print('Total data amount ${row.length * count} UTF-16 code units.');\n  print('The data will arrive in ${chunk.length} UTF-16 code unit chunks.');\n  var i = 0;\n  Timer.periodic(Duration.zero, (timer) {\n    sink.add(chunk);\n    i += rowsInChunk;\n    if (i < count) {\n      sink.add('\\n');\n    }\n    if (i >= count) {\n      controller.close();\n      timer.cancel();\n    }\n  });\n  return controller.stream;\n}\nFuture<void> _exampleParseStreamWithEvents() async {\n  print('=========================');\n  print('Start streaming parsing with events');\n  // Get external data\n  final stream = _createStream();\n  final sw = Stopwatch();\n  sw.start();\n  final parser = _MyParser(() async {\n    print('Saving to virtual database complete in ${sw.elapsed}');\n    sw.stop();\n  });\n  await stream.transform(CsvConverter(parser: parser)).first;\n}\nvoid _exampleParseString() {\n  print('=========================');\n  print('Parsing string');\n  final result = CsvConverter().convert(_data);\n  print(result.join('\\n'));\n  for (var i = 1; i < result.length; i++) {\n    final row = result[i];\n    final car = row[1];\n    final price = num.parse(row[4]);\n    print('$car $price');\n  }\n}\nclass _MyParser extends CsvParser {\n  final Future<void> Function()? onComplete;\n  int _count = 0;\n  int _totalCount = 0;\n  int _transactionCount = 0;\n  final List<List<String>> _rows = [];\n  _MyParser([this.onComplete]);\n  @override\n  void beginEvent(CsvParserEvent event) {\n    if (event == CsvParserEvent.startEvent) {\n      _count = 0;\n      _totalCount = 0;\n      _transactionCount = 0;\n      _rows.clear();\n    }\n  }\n  @override\n  R? endEvent<R>(CsvParserEvent event, R? result, bool ok) {\n    void saveRows(bool isLast) {\n      final rows = _rows.toList();\n      _rows.clear();\n      Timer.run(() async {\n        // Asynchronous saving to the database.\n        await _saveToDatabase(rows, isLast);\n      });\n    }\n    if (ok) {\n      switch (event) {\n        case CsvParserEvent.rowEvent:\n          final row = result as List<String>;\n          _rows.add(row);\n          if (_rows.length > 10000) {\n            saveRows(false);\n          }\n          // Free memory\n          result = const <String>[] as R;\n          break;\n        case CsvParserEvent.startEvent:\n          saveRows(true);\n          if (onComplete != null) {\n            Timer.run(onComplete!);\n          }\n          // Completely freeing memory from the entire list\n          result = const <List<String>>[] as R;\n        default:\n      }\n    }\n    return result;\n  }\n  Future<void> _saveToDatabase(List<List<String>> rows, bool isLast) async {\n    _transactionCount++;\n    _count += rows.length;\n    _totalCount += rows.length;\n    if (_count > 100000 || isLast) {\n      print(\n          'Saved to virtual database $_totalCount row(s) in $_transactionCount transaction(s)');\n      _count = 0;\n    }\n    if (isLast) {\n      print(\n          'Totally saved to virtual database $_totalCount row(s) in $_transactionCount transaction(s)');\n    }\n  }\n}\n```\nOutput:\n```\n=========================\nParsing string\n[Year, Make, Model, Description, Price]\n[1997, Ford, E350, ac, abs, moon, 3000.00]\n[1999, Chevy, Venture \"Extended Edition\", , 4900.00]\n[1999, Chevy, Venture \"Extended Edition, Very Large\", , 5000.00]\n[1996, Jeep, Grand Cherokee, MUST SELL!\nair, moon roof, loaded, 4799.00]\nFord 3000.0\nChevy 4900.0\nChevy 5000.0\nJeep 4799.0\n=========================\nStart streaming parsing with events\nTotal data amount 52000000 UTF-16 code units.\nThe data will arrive in 529999 UTF-16 code unit chunks.\nSaved to virtual database 100010 row(s) in 10 transaction(s)\nSaved to virtual database 200020 row(s) in 20 transaction(s)\nSaved to virtual database 300030 row(s) in 30 transaction(s)\nSaved to virtual database 400040 row(s) in 40 transaction(s)\nSaved to virtual database 500050 row(s) in 50 transaction(s)\nSaved to virtual database 600060 row(s) in 60 transaction(s)\nSaved to virtual database 700070 row(s) in 70 transaction(s)\nSaved to virtual database 800080 row(s) in 80 transaction(s)\nSaved to virtual database 900090 row(s) in 90 transaction(s)\nSaved to virtual database 1000000 row(s) in 100 transaction(s)\nTotally saved to virtual database 1000000 row(s) in 100 transaction(s)\nSaving to virtual database complete in 0:00:04.087358\n```\n## An example of using a configurable parser\nThis parser is slightly slower than the non-configurable parser.\nThe difference between using a normal parser and using a configurable parser is that you can specify a field separator.\nAny value (such as a space or semicolon).\n```dart\nimport 'package:fast_csv/csv_ex_converter.dart';\nvoid main(List<String> args) {\n  final parser = CsvExParser(separator: ';');\n  final result = CsvExConverter(parser: parser).convert(_data);\n  print(result.join('\\n'));\n  for (var i = 1; i < result.length; i++) {\n    final row = result[i];\n    final car = row[1];\n    final price = num.parse(row[4]);\n    print('$car $price');\n  }\n}\nconst _data = '''\nYear;Make;Model;Description;Price\n1997;Ford;E350;\"ac, abs, moon\";3000.00\n1999;Chevy;\"Venture \"\"Extended Edition\"\"\";\"\";4900.00\n1999;Chevy;\"Venture \"\"Extended Edition, Very Large\"\"\";\"\";5000.00\n1996;Jeep;Grand Cherokee;\"MUST SELL!\nair, moon roof, loaded\";4799.00\n''';\n```\n## About the implementation of parsers\nParsers are generated from PEG grammars.\nSoftware used to generate parsers [![Pub Package](https://img.shields.io/pub/v/peg.svg)](https://pub.dev/packages/peg)\nBelow is the source code for one of the grammars.\n```\n%%\nconst CsvParser();\n%%\n@event\nStart = v:Rows Eol? @eof() ;\n@inline\nChars = ($[^\"]+ / '\"\"' <String>{ $$ = '\"'; })* ;\n@inline\nCloseQuote = '\"' Spaces ;\nEol = '\\n' / '\\r\\n' / '\\r' ;\n@event\n@inline\nField = String / Text ;\n@inline\nOpenQuote = Spaces '\"' ;\n@event\nRow = @list1(Field, ',' ↑ v:Field) ;\n@inline\nRowEnding = Eol !@eof() ;\nRows = v:@list1(Row, RowEnding ↑ v:Row) ;\nSpaces = [ \\t]* ;\nString\nString = OpenQuote ↑ v:Chars CloseQuote { $$ = v.join(); } ;\nText = $[^,\"\\n\\r]* ;\n```\n## Libraries\n[csv\\_converter](https://pub.dev/documentation/fast_csv/csv_converter/)\n[csv\\_ex\\_converter](https://pub.dev/documentation/fast_csv/csv_ex_converter/)\n[csv\\_ex\\_parser](https://pub.dev/documentation/fast_csv/csv_ex_parser/)\n[csv\\_parser](https://pub.dev/documentation/fast_csv/csv_parser/)\n[fast\\_csv](https://pub.dev/documentation/fast_csv/fast_csv/)\n[fast\\_csv\\_ex](https://pub.dev/documentation/fast_csv/fast_csv_ex/)\n1.  [fast\\_csv package](https://pub.dev/packages/fast_csv)\n2.  documentation\n##### fast\\_csv package\n1.  Libraries\n2.  [csv\\_converter](https://pub.dev/documentation/fast_csv/csv_converter/)\n3.  [csv\\_ex\\_converter](https://pub.dev/documentation/fast_csv/csv_ex_converter/)\n4.  [csv\\_ex\\_parser](https://pub.dev/documentation/fast_csv/csv_ex_parser/)\n5.  [csv\\_parser](https://pub.dev/documentation/fast_csv/csv_parser/)\n6.  [fast\\_csv](https://pub.dev/documentation/fast_csv/fast_csv/)\n7.  [fast\\_csv\\_ex](https://pub.dev/documentation/fast_csv/fast_csv_ex/)\nfast\\_csv 0.2.11",
  "timestamp": 1769963940161,
  "title": "fast_csv - Dart API docs"
}