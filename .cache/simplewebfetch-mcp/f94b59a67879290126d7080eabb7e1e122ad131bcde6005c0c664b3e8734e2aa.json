{
  "url": "https://pub.dev/packages/mocktail",
  "markdown": "# mocktail | Dart package\n[![](https://pub.dev/static/hash-jnfujih4/img/pub-dev-logo.svg)](https://pub.dev/)\nSign in\nHelp\n### pub.dev\n[Searching for packages](https://pub.dev/help/search)[Package scoring and pub points](https://pub.dev/help/scoring)\n### Flutter\n[Using packages](https://flutter.dev/using-packages/)[Developing packages and plugins](https://flutter.dev/developing-packages/)[Publishing a package](https://dart.dev/tools/pub/publishing)\n### Dart\n[Using packages](https://dart.dev/guides/packages)[Publishing a package](https://dart.dev/tools/pub/publishing)\n### pub.dev ![toggle folding of the section](https://pub.dev/static/hash-jnfujih4/img/nav-mobile-foldable-icon.svg)\n[Searching for packages](https://pub.dev/help/search)[Package scoring and pub points](https://pub.dev/help/scoring)\n### Flutter ![toggle folding of the section](https://pub.dev/static/hash-jnfujih4/img/nav-mobile-foldable-icon.svg)\n[Using packages](https://flutter.dev/using-packages/)[Developing packages and plugins](https://flutter.dev/developing-packages/)[Publishing a package](https://dart.dev/tools/pub/publishing)\n### Dart ![toggle folding of the section](https://pub.dev/static/hash-jnfujih4/img/nav-mobile-foldable-icon.svg)\n[Using packages](https://dart.dev/guides/packages)[Publishing a package](https://dart.dev/tools/pub/publishing)\n# mocktail 1.0.4 ![copy \"mocktail: ^1.0.4\" to clipboard](https://pub.dev/static/hash-jnfujih4/img/content-copy-icon.svg \"Copy \"mocktail: ^1.0.4\" to clipboard\")\nmocktail: ^1.0.4 copied to clipboard\nPublished 19 months ago â€¢ [![verified publisher](https://pub.dev/static/hash-jnfujih4/img/material-icon-verified.svg \"Published by a pub.dev verified publisher\")felangel.dev](https://pub.dev/publishers/felangel.dev)\nSDK[Dart](https://pub.dev/packages?q=sdk%3Adart \"Packages compatible with Dart SDK\")[Flutter](https://pub.dev/packages?q=sdk%3Aflutter \"Packages compatible with Flutter SDK\")\nPlatform[Android](https://pub.dev/packages?q=platform%3Aandroid \"Packages compatible with Android platform\")[iOS](https://pub.dev/packages?q=platform%3Aios \"Packages compatible with iOS platform\")[Linux](https://pub.dev/packages?q=platform%3Alinux \"Packages compatible with Linux platform\")[macOS](https://pub.dev/packages?q=platform%3Amacos \"Packages compatible with macOS platform\")[web](https://pub.dev/packages?q=platform%3Aweb \"Packages compatible with Web platform\")[Windows](https://pub.dev/packages?q=platform%3Awindows \"Packages compatible with Windows platform\")\n![liked status: inactive](https://pub.dev/static/hash-jnfujih4/img/like-inactive.svg)![liked status: active](https://pub.dev/static/hash-jnfujih4/img/like-active.svg)1.2k\nâ†’\n### Metadata\nA Dart mock library which simplifies mocking with null safety support and no manual mocks or code generation.\nMore...\n-   Readme\n-   [Changelog](https://pub.dev/packages/mocktail/changelog)\n-   [Example](https://pub.dev/packages/mocktail/example)\n-   [Installing](https://pub.dev/packages/mocktail/install)\n-   [Versions](https://pub.dev/packages/mocktail/versions)\n-   [Scores](https://pub.dev/packages/mocktail/score)\n# ðŸ¹ mocktail [#](#-mocktail)\n[![Pub](https://img.shields.io/pub/v/mocktail.svg)](https://pub.dev/packages/mocktail) [![mocktail](https://github.com/felangel/mocktail/actions/workflows/mocktail.yaml/badge.svg)](https://github.com/felangel/mocktail/actions) [![coverage](https://raw.githubusercontent.com/felangel/mocktail/main/coverage_badge.svg)](https://github.com/felangel/mocktail/actions) [![License: MIT](https://img.shields.io/badge/license-MIT-purple.svg)](https://opensource.org/licenses/MIT)\n---\nMock library for Dart inspired by [mockito](https://pub.dev/packages/mockito).\nMocktail focuses on providing a familiar, simple API for creating mocks in Dart (with null-safety) without the need for manual mocks or code generation.\n## Creating a Mock [#](#creating-a-mock)\n```dart\nimport 'package:mocktail/mocktail.dart';\n// A Real Cat class\nclass Cat {\n  String sound() => 'meow!';\n  bool likes(String food, {bool isHungry = false}) => false;\n  final int lives = 9;\n}\n// A Mock Cat class\nclass MockCat extends Mock implements Cat {}\nvoid main() {\n  // Create a Mock Cat instance\n  final cat = MockCat();\n}\n```\n## Stub and Verify Behavior [#](#stub-and-verify-behavior)\nThe `MockCat` instance can then be used to stub and verify calls.\n```dart\n// Stub the `sound` method.\nwhen(() => cat.sound()).thenReturn('meow');\n// Verify no interactions have occurred.\nverifyNever(() => cat.sound());\n// Interact with the mock cat instance.\ncat.sound();\n// Verify the interaction occurred.\nverify(() => cat.sound()).called(1);\n// When mocktail verifies an invocation, it is then excluded from further verifications.\nverifyNever(() => cat.sound());\n// Interact with the mock instance again.\ncat.sound();\n// The verification count is 1 since there was only 1 invocation since the last verification.\nverify(() => cat.sound()).called(1);\n```\n## Additional Usage [#](#additional-usage)\n```dart\n// Stub a method before interacting with the mock.\nwhen(() => cat.sound()).thenReturn('purrr!');\nexpect(cat.sound(), 'purrr!');\n// You can interact with the mock multiple times.\nexpect(cat.sound(), 'purrr!');\n// You can change the stub.\nwhen(() => cat.sound()).thenReturn('meow!');\nexpect(cat.sound(), 'meow');\n// You can stub getters.\nwhen(() => cat.lives).thenReturn(10);\nexpect(cat.lives, 10);\n// You can stub a method for specific arguments.\nwhen(() => cat.likes('fish', isHungry: false)).thenReturn(true);\nexpect(cat.likes('fish', isHungry: false), isTrue);\n// You can verify the interaction for specific arguments.\nverify(() => cat.likes('fish', isHungry: false)).called(1);\n// Or alternatively use any(that: ...) to use a matcher.\nverify(() => cat.likes(any(that: isA<String>().having((food) => food, 'name', 'fish')))).called(1);\n// You can stub a method using argument matcher: `any`.\n// When stubbing a positional argument, use `any()`.\n// When stubbing a named argument, use `any(named: '<argName>`)`.\n// A custom matcher can be provided using `any(that: customMatcher)`.\nwhen(() => cat.likes(any(), isHungry: any(named: 'isHungry', that: isFalse)).thenReturn(true);\nexpect(cat.likes('fish', isHungry: false), isTrue);\n// You can stub a method to throw.\nwhen(() => cat.sound()).thenThrow(Exception('oops'));\nexpect(() => cat.sound(), throwsA(isA<Exception>()));\n// You can calculate stubs dynamically.\nfinal sounds = ['purrr', 'meow'];\nwhen(() => cat.sound()).thenAnswer((_) => sounds.removeAt(0));\nexpect(cat.sound(), 'purrr');\nexpect(cat.sound(), 'meow');\n// You can capture any argument.\nwhen(() => cat.likes('fish')).thenReturn(true);\nexpect(cat.likes('fish'), isTrue);\nfinal captured = verify(() => cat.likes(captureAny())).captured;\nexpect(captured.last, equals(['fish']));\n// You can capture a specific argument based on a matcher.\nwhen(() => cat.likes(any())).thenReturn(true);\nexpect(cat.likes('fish'), isTrue);\nexpect(cat.likes('dog food'), isTrue);\nfinal captured = verify(() => cat.likes(captureAny(that: startsWith('d')))).captured;\nexpect(captured.last, equals(['dog food']));\n```\n## Resetting Mocks [#](#resetting-mocks)\n```dart\nreset(cat); // Reset stubs and interactions\n```\n## How it works [#](#how-it-works)\nMocktail uses closures to handle catching `TypeError` instances which would otherwise propagate and cause test failures when stubbing/verifying non-nullable return types. Check out [#24](https://github.com/felangel/mocktail/issues/24) for more information.\nIn order to support argument matchers such as `any` and `captureAny` mocktail has to register default fallback values to return when the argument matchers are used. Out of the box, it automatically handles all primitive types, however, when using argument matchers in place of custom types developers must use `registerFallbackValue` to provide a default return value. It is only required to call `registerFallbackValue` once per type so it is recommended to place all `registerFallbackValue` calls within `setUpAll`.\n```dart\nclass Food {...}\nclass Cat {\n  bool likes(Food food) {...}\n}\n...\nclass MockCat extends Mock implements Cat {}\nclass FakeFood extends Fake implements Food {}\nvoid main() {\n  setUpAll(() {\n    registerFallbackValue(FakeFood());\n  });\n  test('...', () {\n    final cat = MockCat();\n    when(() => cat.likes(any()).thenReturn(true);\n    ...\n  });\n}\n```\n## FAQs [#](#faqs)\n#### Why am I getting an invalid\\_implementation\\_override error when trying to Fake certain classes like ThemeData and ColorScheme?\n[Relevant Issue](https://github.com/felangel/mocktail/issues/59)\nThis is likely due to differences in the function signature of `toString` for the class and can be resolved using a mixin as demonstrated below:\n```dart\nmixin DiagnosticableToStringMixin on Object {\n  @override\n  String toString({DiagnosticLevel minLevel = DiagnosticLevel.info}) {\n    return super.toString();\n  }\n}\nclass FakeThemeData extends Fake\n  with DiagnosticableToStringMixin\n  implements ThemeData {}\n```\n#### Why can't I stub/verify extension methods properly?\n[Relevant Issue](https://github.com/felangel/mocktail/issues/58)\nExtension methods cannot be stubbed/verified as they are treated like static methods. This means that calls go directly to the extension method without caring about the instance. As a result, stubs and verify calls to extensions always result in an invocation of the real extension method.\nInstead of stubbing/verifying extension methods directly, prefer to stub/verify public members on the instance with which the extension methods interact.\n#### Why am I seeing error: type 'Null' is not a subtype of type 'Future\n[Relevant Issue](https://github.com/felangel/mocktail/issues/78)\nBy default when a class extends `Mock` any unstubbed methods return `null`.\nFor example, take the following class:\n```dart\nclass Person {\n  Future<void> sleep() {\n    await Future<void>.delayed(Duration(hours: 8));\n  }\n}\n```\nWe can create a `MockPerson` like:\n```dart\nclass MockPerson extends Mock implements Person {}\n```\nIf we have code that invokes `sleep` on `MockPerson` we will get a `TypeError`:\n```sh\ntype 'Null' is not a subtype of type 'Future<void>'\n```\nThis is because we did not stub `sleep` so when `sleep` is called on an instance of `MockPerson`, `mocktail` returns `null` which is not compatible with `Future<void>`.\nTo address this, we must explicitly stub `sleep` like:\n```dart\nfinal person = MockPerson();\nwhen(() => person.sleep()).thenAnswer((_) async {});\n```\n#### Why is my method throwing a `TypeError` when stubbing using `any()`?\n[Relevant Issue](https://github.com/felangel/mocktail/issues/162)\nBy default when a class extends `Mock` any unstubbed methods return `null`. When stubbing using `any()` the type must be inferable. However, when a method has a generic type argument it might not be able to infer the type and as a result, the generic would fallback to `dynamic` causing the method to act as if it was unstubbed.\nFor example, take the following class and its method:\n```dart\nclass Cache {\n  bool set<T>(String key, T value) {\n    return true;\n  }\n}\n```\nThe following stub will be equivalent to calling `set<dynamic>(...)`:\n```dart\n// The type `T` of `any<T>()` is inferred to be `dynamic`.\nwhen(() => cache.set(any(), any())).thenReturn((_) => true);\n```\nTo address this, we must explicitly stub `set` with a type:\n```dart\nfinal cache = MockCache();\nwhen(() => cache.set<int>(any(), any())).thenReturn((_) => true);\ncache.set<int>('key', 1);\nverify(() => cache.set<int>(any(), any())).called(1);\n```\nThe type doesn't need to be applied to `set<T>()`, any explicit type that allows `any<T>()` infer its type will allow the method to be stubbed for that type:\n```dart\nwhen(() => cache.set(any(), any<int>())).thenReturn((_) => true);\n```\n[\n1.21k\nlikes\n160\npoints\n1.49M\ndownloads\n](https://pub.dev/packages/mocktail/score)\n### Publisher\n[![verified publisher](https://pub.dev/static/hash-jnfujih4/img/material-icon-verified.svg \"Published by a pub.dev verified publisher\")felangel.dev](https://pub.dev/publishers/felangel.dev)\n### Weekly Downloads\n### Metadata\nA Dart mock library which simplifies mocking with null safety support and no manual mocks or code generation.\n[Homepage](https://github.com/felangel/mocktail/tree/main/packages/mocktail)\n[Repository (GitHub)](https://github.com/felangel/mocktail)\n[View/report issues](https://github.com/felangel/mocktail/issues)\n### Topics\n[#mock](https://pub.dev/packages?q=topic%3Amock) [#testing](https://pub.dev/packages?q=topic%3Atesting \"Packages that facilitate testing.\")\n### Documentation\n[API reference](https://pub.dev/documentation/mocktail/latest/)\n### License\n![](https://pub.dev/static/hash-jnfujih4/img/material-icon-balance.svg)MIT ([license](https://pub.dev/packages/mocktail/license))\n### Dependencies\n[collection](https://pub.dev/packages/collection \"^1.15.0\"), [matcher](https://pub.dev/packages/matcher \"^0.12.15\"), [test\\_api](https://pub.dev/packages/test_api \">=0.2.1 <0.8.0\")\n### More\n[Packages that depend on mocktail](https://pub.dev/packages?q=dependency%3Amocktail)\n### â† Metadata\n[\n1.21k\nlikes\n160\npoints\n1.49M\ndownloads\n](https://pub.dev/packages/mocktail/score)\n### Publisher\n[![verified publisher](https://pub.dev/static/hash-jnfujih4/img/material-icon-verified.svg \"Published by a pub.dev verified publisher\")felangel.dev](https://pub.dev/publishers/felangel.dev)\n### Weekly Downloads\n### Metadata\nA Dart mock library which simplifies mocking with null safety support and no manual mocks or code generation.\n[Homepage](https://github.com/felangel/mocktail/tree/main/packages/mocktail)\n[Repository (GitHub)](https://github.com/felangel/mocktail)\n[View/report issues](https://github.com/felangel/mocktail/issues)\n### Topics\n[#mock](https://pub.dev/packages?q=topic%3Amock) [#testing](https://pub.dev/packages?q=topic%3Atesting \"Packages that facilitate testing.\")\n### Documentation\n[API reference](https://pub.dev/documentation/mocktail/latest/)\n### License\n![](https://pub.dev/static/hash-jnfujih4/img/material-icon-balance.svg)MIT ([license](https://pub.dev/packages/mocktail/license))\n### Dependencies\n[collection](https://pub.dev/packages/collection \"^1.15.0\"), [matcher](https://pub.dev/packages/matcher \"^0.12.15\"), [test\\_api](https://pub.dev/packages/test_api \">=0.2.1 <0.8.0\")\n### More\n[Packages that depend on mocktail](https://pub.dev/packages?q=dependency%3Amocktail)\nBack\n![previous](https://pub.dev/static/hash-jnfujih4/img/keyboard_arrow_left.svg)\n![next](https://pub.dev/static/hash-jnfujih4/img/keyboard_arrow_right.svg)\n[Dart language](https://dart.dev/)[Report package](https://pub.dev/report?subject=package%3Amocktail&url=https%3A%2F%2Fpub.dev%2Fpackages%2Fmocktail)[Policy](https://pub.dev/policy)[Terms](https://www.google.com/intl/en/policies/terms/)[API Terms](https://developers.google.com/terms/)[Security](https://pub.dev/security)[Privacy](https://www.google.com/intl/en/policies/privacy/)[Help](https://pub.dev/help)[![RSS](https://pub.dev/static/hash-jnfujih4/img/rss-feed-icon.svg \"RSS/atom feed\")](https://pub.dev/feed.atom)[![bug report](https://pub.dev/static/hash-jnfujih4/img/bug-report-white-96px.png \"Report an issue with this site\")](https://github.com/dart-lang/pub-dev/issues/new)",
  "timestamp": 1769974093749,
  "title": "mocktail | Dart package"
}