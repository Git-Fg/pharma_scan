{
  "url": "https://drift.simonbinder.eu/generation_options/modular",
  "markdown": "# Modular code generation\n[Drift](https://drift.simonbinder.eu/)\n-   [Docs](https://drift.simonbinder.eu/)\n-   [Guides](https://drift.simonbinder.eu/guides/datetime-migrations)\n-   [Examples](https://drift.simonbinder.eu/examples/)\n-   [pub.dev](https://pub.dev/packages/drift)\n-   [Docs](https://drift.simonbinder.eu/)\n    -   -   [Home](https://drift.simonbinder.eu/)\n        -   [Setup guide](https://drift.simonbinder.eu/setup)\n        -   [FAQ](https://drift.simonbinder.eu/faq)\n    -   Dart reference\n        -   [Defining tables](https://drift.simonbinder.eu/dart_api/tables)\n        -   [Selects](https://drift.simonbinder.eu/dart_api/select)\n        -   [Writes (update, insert, delete)](https://drift.simonbinder.eu/dart_api/writes)\n        -   [Expressions](https://drift.simonbinder.eu/dart_api/expressions)\n        -   [Stream queries](https://drift.simonbinder.eu/dart_api/streams)\n        -   [Schema introspection](https://drift.simonbinder.eu/dart_api/schema_inspection)\n        -   [Views](https://drift.simonbinder.eu/dart_api/views)\n        -   [DAOs](https://drift.simonbinder.eu/dart_api/daos)\n        -   [Manager API](https://drift.simonbinder.eu/dart_api/manager)\n        -   [Transactions](https://drift.simonbinder.eu/dart_api/transactions)\n    -   SQL API reference\n        -   [Overview](https://drift.simonbinder.eu/sql_api)\n        -   [Drift files](https://drift.simonbinder.eu/sql_api/drift_files)\n        -   [SQLite extensions](https://drift.simonbinder.eu/sql_api/extensions)\n        -   [Custom queries](https://drift.simonbinder.eu/sql_api/custom_queries)\n    -   Migrations\n        -   [Overview](https://drift.simonbinder.eu/migrations)\n        -   [Migrator APIs](https://drift.simonbinder.eu/migrations/api)\n        -   [Testing](https://drift.simonbinder.eu/migrations/tests)\n        -   [Helpers](https://drift.simonbinder.eu/migrations/step_by_step)\n        -   [Schema exports](https://drift.simonbinder.eu/migrations/exports)\n    -   Platforms\n        -   [Overview](https://drift.simonbinder.eu/platforms)\n        -   [Native](https://drift.simonbinder.eu/platforms/vm)\n        -   [Web](https://drift.simonbinder.eu/platforms/web)\n        -   [Encryption](https://drift.simonbinder.eu/platforms/encryption)\n        -   [libsql](https://drift.simonbinder.eu/platforms/libsql)\n        -   [PostgreSQL](https://drift.simonbinder.eu/platforms/postgres)\n    -   Generation options\n        -   [Overview](https://drift.simonbinder.eu/generation_options)\n        -   [Modular code generation](https://drift.simonbinder.eu/generation_options/modular)\n        -   [Drift and other builders](https://drift.simonbinder.eu/generation_options/in_other_builders)\n    -   Tools\n        -   [Overview](https://drift.simonbinder.eu/tools)\n        -   [Devtools extension](https://drift.simonbinder.eu/tools/devtools)\n        -   [Community tools](https://drift.simonbinder.eu/community_tools)\n    -   Advanced topics\n        -   [Isolates](https://drift.simonbinder.eu/isolates)\n        -   [Testing](https://drift.simonbinder.eu/testing)\n        -   [Generated table rows](https://drift.simonbinder.eu/dart_api/rows)\n        -   [Type converters](https://drift.simonbinder.eu/type_converters)\n        -   [Custom SQL types](https://drift.simonbinder.eu/sql_api/types)\n[Edit this page](https://github.com/simolus3/drift/edit/develop/docs/content/generation_options/modular.md) [Create documentation issue](https://github.com/simolus3/drift/issues/new?template=docs.md&title=Documentation+issue%3A+Modular+code+generation)\nOn this page[](# \"Top of the page\")\n-   [Enabling modular code generation](#enabling-modular-code-generation)\n-   [What gets generated](#what-gets-generated)\n# Modular code generation\nMake drift generate code in multiple files.\nBy default, drift generates code from a single entrypoint - all tables, views and queries for a database are generated into a single part file. For larger projects, this file can become quite large, slowing down builds and the analyzer when it is re-generated. Drift supports an alternative and modular code-generation mode intended as an alternative for larger projects. With this setup, drift generates multiple files and automatically manages imports between them.\nAs a motivating example, consider a large drift project with many tables or views being split across different files:\n```\nlib/src/database/\n├── database.dart\n├── tables/\n│   ├── users.drift\n│   ├── settings.drift\n│   ├── groups.drift\n│   └── search.drift\n└── views/\n    ├── friends.drift\n    └── categories.dart\n```\nWhile a modular structure (with `import`s in drift files) is helpful to structure sources, drift still generates everything into a single `database.g.dart` file. With a growing number of tables and queries, drift may need to generate tens of thousands of lines of code for data classes, companions and query results.\nWith its modular generation mode, drift instead generates sources for each input file, like this:\n```\nlib/src/database/\n├── database.dart\n├── database.drift.dart\n├── tables/\n│   ├── users.drift\n│   ├── users.drift.dart\n│   ├── settings.drift\n│   ├── settings.drift.dart\n│   └── ...\n└── views/\n    ├── friends.drift\n    ├── friends.drift.dart\n    ├── categories.dart\n    └── categories.drift.dart\n```\n## Enabling modular code generation[#](https://drift.simonbinder.eu/generation_options/modular#enabling-modular-code-generation)\n_Note_: A small example using modular code generation is also part of [drift's repository](https://github.com/simolus3/drift/tree/develop/examples/modular).\nAs drift's modular code generation mode generates different file patterns than the default builder, it needs to be enabled explicitly. For this, create a `build.yaml` file in which you disable the default `drift_dev` build and enable the two builders for modular generation: `drift_dev:analyzer` and `drift_dev:modular`. They should both get the same options:\n```\ntargets:\n  $default:\n    builders:\n      drift_dev:\n        # disable drift's default builder, we're using the modular setup\n        # instead.\n        enabled: false\n      # Instead, enable drift_dev:analyzer and drift_dev:modular manually:\n      drift_dev:analyzer:\n        enabled: true\n        options: &options\n          # Drift build options, as per https://drift.simonbinder.eu/docs/advanced-features/builder_options/\n          store_date_time_values_as_text: true\n          named_parameters: true\n          sql:\n            dialect: sqlite\n            options:\n              version: \"3.39\"\n              modules: [fts5]\n      drift_dev:modular:\n        enabled: true\n        # We use yaml anchors to give the two builders the same options\n        options: *options\n```\n## What gets generated[#](https://drift.simonbinder.eu/generation_options/modular#what-gets-generated)\nWith modular generation, drift generates standalone Dart libraries (Dart files without a `part of` statement). This also means that you no longer need `part` statements in your sources. Instead, you import the generated `.drift.dart` files. And of course, every private mixin/class previously generated under the part files will now be public. Replacing all `_$` (notice the leading space) with `$` (leading space here as well) should probably fix those problems there.\nWhen it comes to using the generated code, not much is different: The API for the database and DAOs stays mostly the same. A big exception are how `.drift` files are handled in the modular generation mode. In the default builder, all queries in all drift files are generated as methods on the database. With modular code generation, drift generates an implicit database accessor reachable through getters from the database class. Consider a file `user.drift` like this:\n```\nCREATE TABLE users (\n  id INTEGER NOT NULL,\n  created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  name TEXT NOT NULL,\n  is_admin BOOLEAN NOT NULL DEFAULT FALSE\n);\nfindUsers($predicate = TRUE): SELECT * FROM users WHERE $predicate;\n```\nIf such a `users.drift` file is included from a database, we no longer generate a `findUsers` method for the database itself. Instead, a `users.drift.dart` file contains a [database accessor](https://drift.simonbinder.eu/dart_api/daos) called `UsersDrift` which is implicitly added to the database. To call `findUsers`, you'd now call `database.usersDrift.findUsers()`.\n-   [](https://github.com/simolus3/drift)\n[](https://jaspr.site \"Built with the Jaspr web framework for Dart.\")\n©2019–2025Simon Binder, Drift authors. Documentation licensed under [CC0 1.0](https://creativecommons.org/publicdomain/zero/1.0/), Drift itself is [MIT-licensed](https://github.com/simolus3/drift/blob/develop/LICENSE)",
  "timestamp": 1769973817803,
  "title": "Modular code generation"
}