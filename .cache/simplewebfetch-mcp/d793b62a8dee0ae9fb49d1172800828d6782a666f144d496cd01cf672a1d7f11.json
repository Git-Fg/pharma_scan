{
  "url": "https://riverpod.dev/docs/3.0_migration",
  "markdown": "# Migrating from 2.0 to 3.0 | Riverpod\n[Skip to main content](#__docusaurus_skipToContent_fallback)\n[\n![Riverpod](https://riverpod.dev/img/logo.png)![Riverpod](https://riverpod.dev/img/logo.png)\n**Riverpod**](https://riverpod.dev/)\n[Docs](https://riverpod.dev/docs/introduction/getting_started)\n[English](#)\n-   [English](https://riverpod.dev/docs/3.0_migration)\n-   [Français](https://riverpod.dev/fr/docs/3.0_migration)\n-   [한국어](https://riverpod.dev/ko/docs/3.0_migration)\n-   [日本語](https://riverpod.dev/ja/docs/3.0_migration)\n-   [Español](https://riverpod.dev/es/docs/3.0_migration)\n-   [বাংলা](https://riverpod.dev/bn/docs/3.0_migration)\n-   [Deutsch](https://riverpod.dev/de/docs/3.0_migration)\n-   [Italiano](https://riverpod.dev/it/docs/3.0_migration)\n-   [Русский](https://riverpod.dev/ru/docs/3.0_migration)\n-   [Türkçe](https://riverpod.dev/tr/docs/3.0_migration)\n-   [简体中文](https://riverpod.dev/zh-Hans/docs/3.0_migration)\n[GitHub](https://github.com/rrousselGit/riverpod)\nSearch\n-   [What's new in Riverpod 3.0](https://riverpod.dev/docs/whats_new)\n-   [Migrating from 2.0 to 3.0](https://riverpod.dev/docs/3.0_migration)\n-   [FAQ](https://riverpod.dev/docs/root/faq)\n-   [DO/DON'T](https://riverpod.dev/docs/root/do_dont)\n-   [Getting started](https://riverpod.dev/docs/introduction/getting_started)\n-   Tutorials\n    -   [Your first Riverpod app](https://riverpod.dev/docs/tutorials/first_app)\n-   Concepts\n    -   [Providers](https://riverpod.dev/docs/concepts2/providers)\n    -   [Consumers](https://riverpod.dev/docs/concepts2/consumers)\n    -   [ProviderContainers/ProviderScopes](https://riverpod.dev/docs/concepts2/containers)\n    -   [Refs](https://riverpod.dev/docs/concepts2/refs)\n    -   [Automatic disposal](https://riverpod.dev/docs/concepts2/auto_dispose)\n    -   [Family](https://riverpod.dev/docs/concepts2/family)\n    -   [Mutations (experimental)](https://riverpod.dev/docs/concepts2/mutations)\n    -   [Offline persistence (experimental)](https://riverpod.dev/docs/concepts2/offline)\n    -   [Automatic retry](https://riverpod.dev/docs/concepts2/retry)\n    -   [ProviderObservers](https://riverpod.dev/docs/concepts2/observers)\n    -   [Provider overrides](https://riverpod.dev/docs/concepts2/overrides)\n    -   [Scoping providers](https://riverpod.dev/docs/concepts2/scoping)\n    -   [About code generation](https://riverpod.dev/docs/concepts/about_code_generation)\n    -   [About hooks](https://riverpod.dev/docs/concepts/about_hooks)\n-   Guides\n    -   [Testing your providers](https://riverpod.dev/docs/how_to/testing)\n    -   [How to reduce provider/widget rebuilds](https://riverpod.dev/docs/how_to/select)\n    -   [How to eagerly initialize providers](https://riverpod.dev/docs/how_to/eager_initialization)\n    -   [Implementing pull-to-refresh](https://riverpod.dev/docs/how_to/pull_to_refresh)\n    -   [How to debounce/cancel network requests](https://riverpod.dev/docs/how_to/cancel)\n-   References\n    -   [All Providers](https://pub.dev/documentation/hooks_riverpod/latest/hooks_riverpod/Provider-class.html)\n    -   [Containers/Scopes](https://pub.dev/documentation/hooks_riverpod/latest/hooks_riverpod/ProviderContainer-class.html)\n    -   [Refs](https://pub.dev/documentation/hooks_riverpod/latest/hooks_riverpod/Ref-class.html)\n    -   [Consumers](https://pub.dev/documentation/hooks_riverpod/latest/hooks_riverpod/ConsumerWidget-class.html)\n    -   [Offline persistence (experimental)](https://pub.dev/documentation/hooks_riverpod/latest/experimental_persist/Storage-class.html)\n    -   [Mutations (experimental)](https://pub.dev/documentation/hooks_riverpod/latest/experimental_mutation/Mutation-class.html)\n    -   [core](https://pub.dev/documentation/hooks_riverpod/latest/hooks_riverpod/AsyncValue-class.html)\n    -   [misc](https://pub.dev/documentation/hooks_riverpod/latest/misc/)\n-   Migration guides\n    -   [Riverpod for Provider Users](https://riverpod.dev/docs/from_provider/quickstart)\n    -   [From \\`StateNotifier\\`](https://riverpod.dev/docs/migration/from_state_notifier)\n    -   [From \\`ChangeNotifier\\`](https://riverpod.dev/docs/migration/from_change_notifier)\n    -   [^0.14.0 to ^1.0.0](https://riverpod.dev/docs/migration/0.14.0_to_1.0.0)\n    -   [^0.13.0 to ^0.14.0](https://riverpod.dev/docs/migration/0.13.0_to_0.14.0)\n-   [Official examples](https://github.com/rrousselGit/riverpod/tree/master/examples/counter)\n-   [Third party examples](https://github.com/dhafinrayhan/dummymart)\n-   [](https://riverpod.dev/)\n-   Migrating from 2.0 to 3.0\nOn this page\n# Migrating from 2.0 to 3.0\nFor the list of changes, please refer to the [What's new in Riverpod 3.0](https://riverpod.dev/docs/whats_new) page.\nRiverpod 3.0 introduces a number of breaking changes that may require you to update your code. They should in general be relatively minor, but we recommend you to read this page carefully.\ninfo\nThis migration is supposed to be smooth.\nIf there is anything that is unclear, or if you encountered a scenario that is difficult to migrate, please [open an issue](https://github.com/rrousselGit/riverpod/issues/new/choose).\nIt is important to us that the migration is as smooth as possible, so we will do our best to help you, improve the migration guide, or even include helpers to make the migration easier.\n## Automatic retry[​](#automatic-retry \"Direct link to Automatic retry\")\nRiverpod 3.0 now [automatically retries](https://riverpod.dev/docs/whats_new#automatic-retry) failing providers by default. This means that if a provider fails to compute its value, it will automatically retry until it succeeds.\nIn general, this is a good thing as it makes your app more resilient to transient errors. However, you may want to disable/customize this behavior in some cases.\nTo disable automatic retry globally, you can do so on `ProviderContainer`/`ProviderScope`:\n-   ProviderScope\n-   ProviderContainer\n```\nvoid main() {  runApp(    ProviderScope(      // Never retry any provider      retry: (retryCount, error) => null,      child: MyApp(),    ),  );}\n```\n```\nvoid main() {  final container = ProviderContainer(    // Never retry any provider    retry: (retryCount, error) => null,  );}\n```\nAlternatively, you can disable automatic retry on a per-provider basis by using the `retry` parameter of the provider:\n-   riverpod\n-   riverpod\\_generator\n```\nfinal todoListProvider = NotifierProvider<TodoList, List<Todo>>(  TodoList.new,  // Never retry this specific provider  retry: (retryCount, error) => null,);\n```\n```\n// Never retry this specific providerDuration? retry(int retryCount, Object error) => null;@Riverpod(retry: retry)class TodoList extends _$TodoList {  @override  List<Todo> build() => [];}\n```\n## Out of view providers are paused[​](#out-of-view-providers-are-paused \"Direct link to Out of view providers are paused\")\nIn Riverpod 3.0, [out of view providers are paused by default](https://riverpod.dev/docs/whats_new#listeners-inside-widgets-that-are-not-visible-are-now-paused).\nThere is currently no way to disable this behavior globally, but you can control the pause behavior at the consumer level by using the [TickerMode](https://api.flutter.dev/flutter/widgets/TickerMode-class.html) widget.\n```\nclass MyWidget extends StatelessWidget {  @override  Widget build(BuildContext context) {    return TickerMode(      enabled: true, // Never pause any descendant listener.      child: Consumer(        builder: (context, ref, child) {          // This \"watch\" will not follow the automatic pausing behavior          // until TickerMode is removed.          final value = ref.watch(myProvider);          return Text(value.toString());        },      ),    );  }}\n```\n## StateProvider, StateNotifierProvider, and ChangeNotifierProvider are moved to a new import[​](#stateprovider-statenotifierprovider-and-changenotifierprovider-are-moved-to-a-new-import \"Direct link to StateProvider, StateNotifierProvider, and ChangeNotifierProvider are moved to a new import\")\nIn Riverpod 3.0, `StateProvider`, `StateNotifierProvider`, and `ChangeNotifierProvider` are considered \"legacy\".\nThey are not removed, but are no longer part of the main API. This is to discourage their use in favor of the new `Notifier` API.\nTo keep using them, you need to change your imports to one of the following:\n```\nimport 'package:hooks_riverpod/legacy.dart';import 'package:flutter_riverpod/legacy.dart';import 'package:riverpod/legacy.dart';\n```\n## Providers now all use == to filter updates[​](#providers-now-all-use--to-filter-updates \"Direct link to Providers now all use == to filter updates\")\nBefore, Riverpod was inconsistent in how it filtered updates to providers. Some providers used `==` to filter updates, while others used `identical`. In Riverpod 3.0, [all providers now use `==` to filter updates](https://riverpod.dev/docs/whats_new#all-updateshouldnotify-now-use-).\nThe most likely way for you to be impacted by this change is when using [StreamProvider](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/StreamProvider-class.html)/[StreamNotifier](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/StreamNotifier-class.html), as now stream values will be filtered by `==`. If you need to, you can override `Notifier.updateShouldNotify` to customize the behavior.\n-   riverpod\n-   riverpod\\_generator\n```\nclass TodoList extends StreamNotifier<Todo> {  @override  Stream<Todo> build() => Stream(...);  @override  bool updateShouldNotify(AsyncValue<Todo> previous, AsyncValue<Todo> next) {    // Custom implementation    return true;  }}\n```\n```\n@riverpodclass TodoList extends _$TodoList {  @override  Stream<Todo> build() => Stream(...);  @override  bool updateShouldNotify(AsyncValue<Todo> previous, AsyncValue<Todo> next) {    // Custom implementation    return true;  }}\n```\nIn the scenario where you didn't use a `Notifier`, you can refactor your provider in its notifier equivalent (Such as converting [StreamProvider](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/StreamProvider-class.html) to [StreamNotifierProvider](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/StreamNotifierProvider.html)).\n## ProviderObserver has its interface slightly changed[​](#providerobserver-has-its-interface-slightly-changed \"Direct link to ProviderObserver has its interface slightly changed\")\nFor the sake of [mutations](https://riverpod.dev/docs/whats_new#mutations), the [ProviderObserver](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/ProviderObserver-class.html) interface has changed slightly.\nInstead of two separate parameters for [ProviderContainer](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/ProviderContainer-class.html) and [ProviderBase](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/ProviderBase-class.html), a single `ProviderObserverContext` object is passed. This object contains both the container, provider, and extra information (such as the associated mutation).\nTo migrate, you need to update all methods of your observers like so:\n```\nclass MyObserver extends ProviderObserver {  @override-  void didAddProvider(ProviderBase provider, Object? value, ProviderContainer container) {+  void didAddProvider(ProviderObserverContext context, Object? value) {    // ...  }}\n```\n## Simplified Ref and removed Ref subclasses[​](#simplified-ref-and-removed-ref-subclasses \"Direct link to Simplified Ref and removed Ref subclasses\")\nFor the sake of simplification, [Ref](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/Ref-class.html) has lost its type parameter, and all properties/methods that were using the type parameter have been moved to [Notifier](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/Notifier-class.html)s.\nSpecifically, `ProviderRef.state`, `Ref.listenSelf` and `FutureProviderRef.future` should be replaced by `Notifier.state`, `Notifier.listenSelf` and `AsyncNotifier.future` respectively.\n-   riverpod\n-   riverpod\\_generator\n```\n// Before:final valueProvider = FutureProvider<int>((ref) async {  ref.listen(anotherProvider, (previous, next) {    ref.state++;  });    ref.listenSelf((previous, next) {    print('Log: $previous -> $next');  });    ref.future.then((value) {    print('Future: $value');  });  return 0;});// Afterclass Value extends AsyncNotifier<int> {  @override  Future<int> build() async {    ref.listen(anotherProvider, (previous, next) {      ref.state++;    });      listenSelf((previous, next) {      print('Log: $previous -> $next');    });      future.then((value) {      print('Future: $value');    });      return 0;  }}final valueProvider = AsyncNotifierProvider<Value, int>(Value.new);\n```\n```\n// Before:@riverpodFuture<int> value(ValueRef ref) async {  ref.listen(anotherProvider, (previous, next) {    ref.state++;  });    ref.listenSelf((previous, next) {    print('Log: $previous -> $next');  });    ref.future.then((value) {    print('Future: $value');  });  return 0;}// After@riverpodclass Value extends _$Value {  @override  Future<int> build() async {    ref.listen(anotherProvider, (previous, next) {      ref.state++;    });      listenSelf((previous, next) {      print('Log: $previous -> $next');    });      future.then((value) {      print('Future: $value');    });      return 0;  }}\n```\nSimilarly, all [Ref](https://pub.dev/documentation/flutter_riverpod/latest/flutter_riverpod/Ref-class.html) subclasses are removed (such as but not limited to `ProviderRef`, `FutureProviderRef`, etc).\nThis primarily affects code-generation. Instead of `MyProviderRef`, you can now use `Ref` directly:\n```\n@riverpod-int example(ExampleRef ref) {+int example(Ref ref) {  // ...}\n```\n## AutoDispose interfaces are removed.[​](#autodispose-interfaces-are-removed \"Direct link to AutoDispose interfaces are removed.\")\nThe auto-dispose feature is simplified. Instead of relying on a clone of all interfaces, interfaces are unified. In short, instead of `AutoDisposeProvider`, `AutoDisposeNotifier`, etc, you now have `Provider`, `Notifier`, etc. The behavior is the same, but the API is simplified.\nTo easily migrate, you can do a case-sensitive replace of `AutoDispose` to (empty string).\n## The family variant of Notifiers is removed[​](#the-family-variant-of-notifiers-is-removed \"Direct link to The family variant of Notifiers is removed\")\nIn the same vein as the previous point, the family variant of Notifiers has been removed. Now, we only use `Notifier`/`AsyncNotifier`/`StreamNotifier`, and `FamilyNotifier`/... have been removed.\nTo migrate, you will need to replace:\n-   `FamilyNotifier` -> `Notifier`\n-   `FamilyAsyncNotifier` -> `AsyncNotifier`\n-   `FamilyStreamNotifier` -> `StreamNotifier`\nThen, you will need to:\n-   Remove the parameter from the `build` method\n-   Add a constructor on your Notifier\nAn example of this migration is as follows:\n```\nfinal provider = NotifierProvider.family<CounterNotifier, int, String>(CounterNotifier.new);-class CounterNotifier extends FamilyNotifier<int, String> {+class CounterNotifier extends Notifier<int> {+  CounterNotifier(this.arg);+  final String arg;   @override-  int build(String arg) {+  int build() {     // Use `arg` as needed      return 0;   }}\n```\n## Provider failures are now rethrown as ProviderExceptions[​](#provider-failures-are-now-rethrown-as-providerexceptions \"Direct link to Provider failures are now rethrown as ProviderExceptions\")\nIn Riverpod 3.0, all provider failures are [rethrown as `ProviderException`s](https://riverpod.dev/docs/whats_new#when-reading-a-provider-results-in-an-exception-the-error-is-now-wrapped-in-a-providerexception). This means that if a provider fails to compute its value, reading it will throw a `ProviderException` instead of the original error.\nThis can impact you if you were relying on the original error type to handle specific errors. To migrate, you can catch the `ProviderException` and extract the original error from it:\n```\ntry {  await ref.read(myProvider.future);-} on NotFoundException {-  // Handle NotFoundException+} on ProviderException catch (e) {+  if (e.exception is NotFoundException) {+    // Handle NotFoundException+  }}\n```\ninfo\nThis is only necessary if you were explicitly relying on try/catch to handle such error.\nIf you are using \\[AsyncValue\\] to check for errors, you don't need to change anything:\n```\nAsyncValue<int> value = ref.watch(myProvider);if (value.error is NotFoundException) {  // Handle NotFoundException  // This still works today}\n```\n[Edit this page](https://github.com/rrousselGit/riverpod/edit/master/website/docs/3.0_migration.mdx)\n[\nPrevious\nWhat's new in Riverpod 3.0\n](https://riverpod.dev/docs/whats_new)[\nNext\nFAQ\n](https://riverpod.dev/docs/root/faq)\n-   [Automatic retry](#automatic-retry)\n-   [Out of view providers are paused](#out-of-view-providers-are-paused)\n-   [StateProvider, StateNotifierProvider, and ChangeNotifierProvider are moved to a new import](#stateprovider-statenotifierprovider-and-changenotifierprovider-are-moved-to-a-new-import)\n-   [Providers now all use == to filter updates](#providers-now-all-use--to-filter-updates)\n-   [ProviderObserver has its interface slightly changed](#providerobserver-has-its-interface-slightly-changed)\n-   [Simplified Ref and removed Ref subclasses](#simplified-ref-and-removed-ref-subclasses)\n-   [AutoDispose interfaces are removed.](#autodispose-interfaces-are-removed)\n-   [The family variant of Notifiers is removed](#the-family-variant-of-notifiers-is-removed)\n-   [Provider failures are now rethrown as ProviderExceptions](#provider-failures-are-now-rethrown-as-providerexceptions)\nDocs\n-   [Getting started](https://riverpod.dev/docs/introduction/getting_started)\n-   [What's new in Riverpod 3.0](https://riverpod.dev/docs/whats_new)\n-   [FAQ](https://riverpod.dev/docs/root/FAQ)\n-   [DO/DON'T](https://riverpod.dev/docs/root/do_dont)\nCommunity\n-   [Discord](https://discord.gg/GSt793j6eT)\n-   [GitHub](https://github.com/rrousselgit/riverpod)\n-   [Stack Overflow](https://stackoverflow.com/questions/tagged/riverpod)\n-   [Twitter](https://twitter.com/remi_rousselet)\n-   [Code of conduct](https://github.com/rrousselGit/riverpod/blob/master/CODE_OF_CONDUCT.md)\n-   [Contributing guide](https://github.com/rrousselGit/riverpod/blob/master/CONTRIBUTING.md)\nSponsors\n-   [![Deploys by Netlify](https://www.netlify.com/img/global/badges/netlify-color-bg.svg)](https://www.netlify.com)\n![Riverpod](https://riverpod.dev/img/full_logo.svg)![Riverpod](https://riverpod.dev/img/full_logo.svg)\nCopyright © 2026 Remi Rousselet.\nBuilt with Docusaurus.",
  "timestamp": 1769987713361,
  "title": "Migrating from 2.0 to 3.0 | Riverpod"
}